<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.drp.data.dao.impl.UserDaoImpl" >

    <resultMap id="userMap" type="com.drp.data.entity.User">
        <id property="id" column="id" />
        <result property="uesrName" column="uesrname" />
        <result property="password" column="password" />
    </resultMap>

    <!-- 返回用户集合 -->
    <select id="list" resultMap="userMap">
      select * from user
    </select>

    <!-- 通过用户名查询用户 -->
    <select id="findUserByName" parameterType="string" resultMap="userMap">
        select * FROM USER
        <where>
            username = #{userName}
        </where>
    </select>

    <!-- 通过用户名查询职位 -->
    <select id="findRoleByName" parameterType="string" resultType="string">
        select code from role where id IN (
          select role_id from user as A left join user_role_rel as B on A.id = B.user_id where A.username = #{userName}
        )
    </select>

</mapper>