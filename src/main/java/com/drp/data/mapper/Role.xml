<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.drp.data.dao.impl.RoleDaoImpl">

    <resultMap id="role" type="com.drp.data.entity.Role">
        <id property="id" column="id" />
        <result property="code" column="code" />
        <result property="name" column="name" />
    </resultMap>

    <!-- 通过用户名查询职位id -->
    <select id="getRoleIdByUserName" parameterType="string" resultType="int">
        SELECT b.role_id FROM user as a left join user_role_rel as b on a.id = b.user_id where a.username = #{0}
    </select>

    <!-- 通过职位id查询权限 -->
    <select id="getPerByRoleIds" parameterType="list" resultType="string">
        select distinct b.code from role_per_rel as a left join permission as b on a.per_id = b.id where role_id in(
        <foreach collection="list" index="index" item="item" separator=",">
            ${item}
        </foreach>
        )
    </select>

</mapper>